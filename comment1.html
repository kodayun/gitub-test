<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>팀원에게 한마디 테스트</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        .commentInputbtn {
            margin-top: 10px;
        }

        .commentOutput {
            margin-top: 50px;
        }

        table,
        td {
            border-collapse: collapse;
            width: 800px;
        }

        table td {
            padding: 10px;
            text-align: center;
        }

        table tr:first-child td {
            background-color: black;
            border: 0;
            color: #fff;
        }
    </style>
    <script>
        //등록하기 버튼 구현 파트입니다
        $(document).ready(function () {
            $('#commentBtn').click(function () {
                commentInput();
            });
        });

        function commentInput() {
            let userName = $('#userName').val();
            let userComment = $('#userComment').val();

            let temp_html = `<tr id="tr001" data-name='${userName}' data-comment='${userComment}'>
                <td>${userName}</td>
                <td>${userComment}</td>
                <td> 
                    <button class="commentEditbtn">edit</button>
                </td>
                <td>
                    <button type="button" id="commentDelbtn" href="#" onclick="commentDel('001');">delete</button>
                </td>
            </tr>`;
            $('#commentTable').append(temp_html);
        }

        //edit 버튼 구현 파트입니다
        $(document).on('click', '.commentEditbtn', function() {
            var name = $(this).parents('tr').attr('data-name');
            var comment = $(this).parents('tr').attr('data-comment');

            $(this).parents('tr').find('td:eq(0)').html(`<input name='edit_text' value='${name}'>`);
            $(this).parents('tr').find('td:eq(1)').html(`<textarea name='edit_comment'>${comment}</textarea>`);

            $(this).parents('tr').find('td:eq(2)').prepend("<button class='commentUpdatebtn'>update</button>");
            $(this).hide();//edit 버튼을 숨기고, update 버튼을 붙여줌
        });

        //update 버튼으로 수정 내용을 저장하는 파트 입니다
        $(document).on('click', '.commentUpdatebtn', function() {
            var editName = $(this).parents('tr').find("input[name='edit_text']").val();
            var editComment = $(this).parents('tr').find("textarea[name='edit_comment']").val();

            $(this).parents('tr').find('td:eq(0)').text(editName);
            $(this).parents('tr').find('td:eq(1)').text(editComment);

            $(this).parents('tr').attr('data-name', editName);
            $(this).parents('tr').attr('data-comment', editComment);

            $(this).parents('tr').find('.commentEditbtn').show();
            $(this).remove();
        });

        //delete 버튼 구현 파트입니다
        function commentDel(idx){
            var a = confirm('정말 삭제할까요?');
            if(a){
                $("#tr" +idx).remove();
            }
        }
            </script>
</head>

<body>
    <!--팀원들에 한마디를 입력하는 파트입니다-->
    <form>
        <div>
            <label for="">닉네임:</label>
            <input type="text" id="userName" name="nickname" placeholder="">
        </div>
        <div>
            <label for="">내용:</label>
            <textarea name="comment" id="userComment" rows="3" cols="30" placeholder="하시고 싶은 말을 적어주세요"></textarea>
        </div>
        <div class="commentInputbtn">
            <button type="button" id="commentBtn">등록하기</button>
        </div>
    </form>

        <!--팀원들에 한마디 출력하는 파트입니다-->
    <table class="commentOutput">
        <tbody id="commentTable">
            <tr>
                <td style="width: 15%">닉네임</td>
                <td style="width: 69%">내용</td>
                <td style="width: 8%">수정</td>
                <td style="width: 8%">삭제</td>
            </tr>
        </tbody>
    </table>
</body>

</html>